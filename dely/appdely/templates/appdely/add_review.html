{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Reseña</title>
    <link rel="stylesheet" href="{% static 'appdely/css/reviws.css' %}">
    <link rel="stylesheet" href="{% static 'appdely/css/details.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div class="container my-5">
        <h1 class="text-center mb-4">Agregar reseña para <span class="text-danger">{{ business.business_name }}</span></h1>
        <div class="form-container mb-5">
            <form method="POST" id="review-form">
                {% csrf_token %}
                <label class="fw-semibold">Calificación:</label>
                <div class="rating-stars text-center mb-3" id="rating-stars">
                    <i class="fa-regular fa-star" data-value="1"></i>
                    <i class="fa-regular fa-star" data-value="2"></i>
                    <i class="fa-regular fa-star" data-value="3"></i>
                    <i class="fa-regular fa-star" data-value="4"></i>
                    <i class="fa-regular fa-star" data-value="5"></i>
                </div>
                <input type="hidden" name="rating" id="rating-input" required>

                <label for="comment">Comentario:</label>
                <textarea name="comment" id="comment" rows="3" placeholder="Escribe tu experiencia..." required style="border-radius:10px; border:1px solid #ddd; padding:10px; width:100%; margin-bottom:15px;"></textarea>

                <button type="submit" style="width:100%; border:none; border-radius:30px; padding:12px; font-weight:600; font-size:1rem; background:#d32f2f; color:#fff; transition:background 0.3s ease;"><i class="fa-solid fa-paper-plane me-2"></i>Enviar reseña</button>
            </form>
        </div>

        <!-- Reseñas recientes -->
        <div id="reviews-list">
            <h4 class="mb-3">Reseñas recientes</h4>
            {% for review in reviews %}
                <div class="review-card">
                    <strong>{{ review.user.username }}</strong> — 
                    <span class="text-warning">{{ review.rating }}★</span><br>
                    <span>{{ review.comment }}</span>
                </div>
            {% empty %}
                <div class="text-muted">Aún no hay reseñas para este negocio.</div>
            {% endfor %}
        </div>
    </div>

    <footer class="text-center py-3 mt-5">
        <small>&copy; 2025 Dely. Todos los derechos reservados.</small>
    </footer>

    <script>
        // Estrellas interactivas
        const stars = document.querySelectorAll('#rating-stars i');
        const ratingInput = document.getElementById('rating-input');

        stars.forEach(star => {
            star.addEventListener('click', function () {
                let value = this.getAttribute('data-value');
                ratingInput.value = value;

                stars.forEach(s => s.classList.remove('fa-solid', 'active'));
                stars.forEach(s => s.classList.add('fa-regular'));

                for (let i = 0; i < value; i++) {
                    stars[i].classList.remove('fa-regular');
                    stars[i].classList.add('fa-solid', 'active');
                }
            });
        });
    </script>
</body>
</html>
